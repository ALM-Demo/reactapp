FROM node:8
RUN mkdir -p /tmp/node_modules && chown -R 1100:node /tmp
WORKDIR /tmp
ADD yarn.lock ./
ADD package.json ./
ENV NODE_PATH=/tmp/node_modules
ENV PATH=$PATH:/tmp/node_modules/.bin
RUN chmod -R 777 /tmp
RUN yarn
WORKDIR /tmp
RUN chown -R 1100:node /tmp/node_modules/*
RUN ls -lrt
RUN useradd -ms /bin/bash 1100
USER 1100
COPY --chown=1100:node . /tmp
EXPOSE 3000
CMD cd /tmp && yarn run start 
